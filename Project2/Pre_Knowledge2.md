# (II) å¯¦é©—äºŒï¼šBER æ›²ç·šç¹ªè£½ (ç†æƒ³é€šé“)

## å…ˆå‚™çŸ¥è­˜ - åŒ¹é…æ¿¾æ³¢å™¨

### ğŸ”¹ ç­‰æ•ˆåŸºé »æ¨¡å‹èˆ‡åŒ¹é…æ¿¾æ³¢ (Matched Filter)

#### 1. RF (å¯¦éš›è¨Šè™Ÿ) æ¨¡å‹

åœ¨å¯¦éš›ç„¡ç·šé€šé“ä¸­ï¼Œå‚³é€ç«¯é€å‡ºçš„è¨Šè™Ÿå½¢å¼ç‚ºï¼š

$s(t) = \sqrt{\tfrac{2E_b}{T_b}} \cos(2\pi f_c t + \phi)$

* \$f\_c\$ï¼šè¼‰æ³¢é »ç‡
* \$T\_b\$ï¼šä¸€å€‹ bit çš„æŒçºŒæ™‚é–“
* \$E\_b\$ï¼šæ¯å€‹ bit çš„èƒ½é‡
* \$\phi\$ï¼šç›¸ä½ (BPSK æ™‚æ˜¯ 0 æˆ– \$\pi\$)

é€™æ˜¯å¯¦éš›ç‰©ç†å±¤é€å‡ºçš„ã€Œé€£çºŒæ™‚é–“ + è¼‰æ³¢ã€è¨Šè™Ÿã€‚

---

#### 2. æ¥æ”¶ç«¯è™•ç†ï¼šè§£èª¿ + åŒ¹é…æ¿¾æ³¢

æ¥æ”¶ç«¯æ‹¿åˆ°ï¼š
$r(t) = s(t) + n(t)$
å…¶ä¸­ \$n(t)\$ æ˜¯ AWGN é›œè¨Šã€‚

æˆ‘å€‘è¦åˆ¤æ–·é€™å€‹ç¬¦è™Ÿæ˜¯ bit 0 é‚„æ˜¯ bit 1ã€‚

å¦‚æœåªæ˜¯ã€Œéš¨ä¾¿å–ä¸€å€‹ç¬é–“å€¼ã€ä¾†åˆ¤æ–·ï¼Œæœƒå¾ˆä¸æº–ï¼Œå› ç‚ºé›œè¨Šåœ¨æ¯å€‹æ™‚é–“é»éƒ½ä¸åŒã€‚

ğŸ‘‰ æ‰€ä»¥æˆ‘å€‘è¦æƒ³è¾¦æ³•ã€Œæ•´åˆæ•´å€‹ bit æœŸé–“çš„èƒ½é‡ã€ï¼ŒæŠŠè¨Šè™Ÿç´¯ç©èµ·ä¾†ï¼Œé€™æ¨£é›œè¨Šçš„å½±éŸ¿ç›¸å°è®Šå°ã€‚

è™•ç†æ­¥é©Ÿï¼š

1. **è§£èª¿ (Demodulation)**ï¼šæŠŠè¨Šè™Ÿæ¬åˆ°åŸºé »ï¼Œæ¶ˆé™¤è¼‰æ³¢ cos æˆåˆ†ã€‚
2. **åŒ¹é…æ¿¾æ³¢ (Matched Filter)**ï¼š
   * åŒ¹é…æ¿¾æ³¢å™¨æ˜¯ä¸€å€‹ç·šæ€§æ¿¾æ³¢å™¨ï¼Œè„ˆè¡éŸ¿æ‡‰è¨­å®šç‚º å‚³é€ç¬¦è™Ÿæ³¢å½¢çš„æ™‚é–“åè½‰ç‰ˆï¼š
      * æ¿¾æ³¢å™¨è„ˆè¡éŸ¿æ‡‰ \$h(t) = s(T\_b - t)\$ã€‚
      * ç›®æ¨™ï¼šæœ€å¤§åŒ–ã€Œå–æ¨£æ™‚åˆ»çš„è¨Šè™Ÿå°é›œè¨Šæ¯” (SNR)ã€ã€‚
      * ç­‰æ•ˆæ–¼æŠŠæ•´å€‹ bit çš„èƒ½é‡ç©åˆ†èµ·ä¾†ï¼Œé›œè¨Šéƒ¨åˆ†å› éš¨æ©Ÿæ€§è€Œéƒ¨åˆ†æŠµæ¶ˆã€‚
---
### ğŸ”¹ ç‚ºä»€éº¼åŒ¹é…æ¿¾æ³¢å™¨èƒ½ç”¢ç”Ÿæœ€å¤§ç›¸é—œ

#### 2.1. æ¿¾æ³¢å™¨è¼¸å‡ºå®šç¾©

æ¥æ”¶ç«¯æ¿¾æ³¢å™¨è¼¸å‡ºï¼š
$y(t) = \int r(\tau) \ h(t-\tau) \ d\tau$

è‹¥é¸æ“‡æ¿¾æ³¢å™¨è„ˆè¡éŸ¿æ‡‰ï¼š
$h(t) = s(T_b - t)$

#####  2.1.1 åŒ¹é…æ¿¾æ³¢æ•¸å­¸æ¨å°

- ä»£å…¥ \$h(t)\$

åŒ¹é…æ¿¾æ³¢å™¨çš„è„ˆè¡éŸ¿æ‡‰ï¼š
$h(t) = s(T_b - t)$

ä»£å…¥å·ç©å…¬å¼ï¼š
$y(t) = \int r(\tau) \ s(T_b - (t - \tau)) \ d\tau$

- å–æ¨£åœ¨ \$t = T\_b\$

é—œæ³¨å–æ¨£æ™‚åˆ» \$t = T\_b\$ï¼š
$y(T_b) = \int r(\tau) \ s(T_b - (T_b - \tau)) \ d\tau$

è£¡é¢å¯ä»¥åŒ–ç°¡ï¼š
$s(T_b - (T_b - \tau)) = s(\tau)$

å› æ­¤ï¼š
$y(T_b) = \int r(\tau) \ s(\tau) \ d\tau$

#### âœ… çµæœæ„ç¾©

* åœ¨ \$t=T\_b\$ æ™‚ï¼Œæ¿¾æ³¢å™¨è¼¸å‡º = æ¥æ”¶è¨Šè™Ÿ \$r(t)\$ èˆ‡åŸå§‹è¨Šè™Ÿ \$s(t)\$ çš„ **å…§ç© (ç›¸é—œå€¼)**ã€‚
* è‹¥ \$r(t) = s(t)\$ï¼ˆç„¡é›œè¨Šï¼‰ï¼Œè¼¸å‡º = è¨Šè™Ÿèƒ½é‡ \$E\_b\$ã€‚
* æœ‰é›œè¨Šæ™‚ï¼Œè¼¸å‡º = è¨Šè™Ÿç›¸é—œå€¼ + é›œè¨Šé …ã€‚

å‰‡åœ¨ \$t=T\_b\$ æ™‚ï¼š
$y(T_b) = \int r(\tau) \ s(\tau) \ d\tau$

---

#### 2. 2. èˆ‡äº’ç›¸é—œçš„é—œä¿‚

* äº’ç›¸é—œå®šç¾©ï¼š
  $(r \star s)(t) = \int r(\tau) \ s(\tau+t) \ d\tau$
* ç•¶ \$t=0\$ï¼š
  $(r \star s)(0) = \int r(\tau) \ s(\tau) \ d\tau$

ğŸ‘‰ å¯ä»¥çœ‹å‡ºï¼Œç•¶ \$t=T\_b\$ï¼ŒåŒ¹é…æ¿¾æ³¢å™¨è¼¸å‡ºå…¶å¯¦å°±æ˜¯ \$r\$ èˆ‡ \$s\$ çš„ **ç›¸é—œå€¼**ã€‚

---

#### 2. 3. ç‚ºä»€éº¼æ˜¯æœ€å¤§åŒ–ï¼Ÿ

è‹¥è¼¸å…¥ \$r(t) = s(t)\$ï¼ˆç„¡é›œè¨Šï¼‰ï¼š
$y(T_b) = \int_0^{T_b} s(\tau) s(\tau) \ d\tau = \int_0^{T_b} |s(\tau)|^2 \ d\tau$

é€™å°±æ˜¯ **è¨Šè™Ÿèƒ½é‡**ï¼š
$y(T_b) = E_b$

* ç•¶è¨Šè™Ÿèˆ‡æ¨¡æ¿å®Œå…¨å°é½Š â†’ è¼¸å‡º = æœ€å¤§èƒ½é‡ã€‚
* è‹¥ä¸æ˜¯åŒä¸€å€‹ç¬¦è™Ÿ (æˆ–æœ‰é›œè¨Š/ç›¸ä½å·®) â†’ ç›¸é—œå€¼æœƒå°æ–¼ \$E\_b\$ã€‚

---

#### 2. 4. ç›´è¦ºç†è§£

* æ¿¾æ³¢å™¨è¼¸å‡º = æ¸¬é‡ã€Œè¼¸å…¥èˆ‡æ¨¡æ¿çš„ç›¸ä¼¼åº¦ã€ã€‚
* è¨­å®š \$h(t) = s(T\_b - t)\$ â†’ åœ¨å–æ¨£æ™‚åˆ»å¾—åˆ°äº’ç›¸é—œå€¼ã€‚
* ç•¶è¼¸å…¥çœŸçš„æ˜¯ \$s(t)\$ â†’ ç›¸é—œå€¼ = èƒ½é‡æœ€å¤§ã€‚
* æ‰€ä»¥åŒ¹é…æ¿¾æ³¢å™¨èƒ½åœ¨å–æ¨£é» **æœ€å¤§åŒ– SNR**ï¼šè¨Šè™Ÿè¢«ç´¯ç©æœ€å¤§ï¼Œé›œè¨Šå› éš¨æ©Ÿæ€§éƒ¨åˆ†æŠµæ¶ˆã€‚

---

#### 3. ç­‰æ•ˆåŸºé »æ¨¡å‹

ç¶“éä¸‹è®Šé » + åŒ¹é…æ¿¾æ³¢å¾Œï¼Œè¨Šè™Ÿç°¡åŒ–ç‚ºï¼š

$y = \pm \sqrt{E_b} + n, \quad n \sim \mathcal{N}(0, N_0/2)$

* \$+\sqrt{E\_b}\$ï¼šå°æ‡‰ bit = 0
* \$-\sqrt{E\_b}\$ï¼šå°æ‡‰ bit = 1
* \$n\$ï¼šç¶“éæ¿¾æ³¢å¾Œçš„ç­‰æ•ˆé«˜æ–¯é›œè¨Š

ğŸ‘‰ é€™å°±æ˜¯ **ç­‰æ•ˆåŸºé »æ¨¡å‹**ï¼šä¸å†éœ€è¦ cos æ³¢å½¢ï¼Œåªä¿ç•™ç¬¦è™Ÿèƒ½é‡èˆ‡é›œè¨Šã€‚

---

#### 4. ç‚ºä»€éº¼ç¬¦è™Ÿæ˜¯ Â±âˆšEbï¼Ÿ

* å®šç¾©ï¼šæ¯ bit èƒ½é‡ \$E\_b = A^2 T\_b\$ã€‚
* å‡è¨­ \$T\_b=1\$ï¼Œå‰‡ \$A = \sqrt{E\_b}\$ã€‚
* å› æ­¤ç¬¦è™Ÿé»å¿…é ˆæ˜¯ï¼š
  $s \in \{+\sqrt{E_b}, -\sqrt{E_b}\}$
* è‹¥è¨­å®š \$E\_b=1\$ï¼Œå°±ç°¡åŒ–ç‚º Â±1ã€‚

---

#### 5. åŒ¹é…æ¿¾æ³¢çš„ç›®çš„

1. **æœ€å¤§åŒ–è¨Šè™Ÿèƒ½é‡**ï¼šæŠŠä¸€æ•´å€‹ bit çš„èƒ½é‡é›†ä¸­åˆ°ä¸€å€‹å–æ¨£é»ã€‚
2. **æœ€å°åŒ–é›œè¨Šå¹²æ“¾**ï¼šåœ¨ AWGN é€šé“ä¸‹å¯è­‰æ˜æ˜¯æœ€ä½³åŒ–çš„ã€‚
3. **è½‰æ›å½¢å¼**ï¼šæŠŠé€£çºŒæ™‚é–“è¨Šè™Ÿè®Šæˆå–®ä¸€æ•¸å€¼ï¼Œæ–¹ä¾¿åˆ¤æ±º bitã€‚

---

### âœ… ç¸½çµ

* **RF å¯¦éš›æ¨¡å‹**ï¼šç”¨ cos è¡¨ç¤ºï¼Œå› ç‚ºç¡¬é«”çœŸçš„åœ¨é€è¼‰æ³¢ã€‚
* **ç­‰æ•ˆåŸºé »æ¨¡å‹**ï¼šåŒ–ç°¡æˆ Â±âˆšEbï¼Œæ–¹ä¾¿æ•¸å­¸åˆ†æ BERã€‚
* **åŒ¹é…æ¿¾æ³¢**ï¼šæœ€ä½³åŒ–æ¥æ”¶å™¨è¨­è¨ˆï¼Œç¢ºä¿åœ¨å–æ¨£é» SNR æœ€é«˜ã€‚

---
## å…ˆå‚™çŸ¥è­˜ - BPSK åœ¨ AWGN é€šé“ä¸‹çš„éŒ¯èª¤æ©Ÿç‡æ¨å°
### ğŸ”¹ BPSK åœ¨ AWGN é€šé“ä¸‹çš„éŒ¯èª¤æ©Ÿç‡æ¨å°

#### 1. æ¥æ”¶æ¨¡å‹

æ¥æ”¶ç«¯ç¬¦è™Ÿï¼š
$y = \pm \sqrt{E_b} + n, \quad n \sim \mathcal{N}(0, N_0/2)$

#### 2. åˆ¤æ±ºè¦å‰‡

æ¥æ”¶ç«¯ä½¿ç”¨é›¶é–€æª»åˆ¤æ±ºï¼š

* è‹¥ \$y > 0\$ â†’ åˆ¤å®š bit = 0
* è‹¥ \$y < 0\$ â†’ åˆ¤å®š bit = 1

å› æ­¤ï¼š

* å‚³é€ \$+\sqrt{E\_b}\$ æ™‚ï¼ŒéŒ¯èª¤æ¢ä»¶æ˜¯ï¼š
  $y = +\sqrt{E_b} + n < 0 \Rightarrow n < -\sqrt{E_b}$
* å‚³é€ \$-\sqrt{E\_b}\$ æ™‚ï¼ŒéŒ¯èª¤æ¢ä»¶æ˜¯ï¼š
  $y = -\sqrt{E_b} + n > 0 \Rightarrow n > \sqrt{E_b}$

é€™å…©ç¨®æƒ…æ³å°ç¨±ï¼ˆå› ç‚ºé›œè¨Š \$n\$ æ˜¯é›¶å‡å€¼ Gaussianï¼‰ï¼Œæ‰€ä»¥åªéœ€è¦è¨ˆç®—å…¶ä¸­ä¸€ç¨®æƒ…æ³å³å¯ã€‚

#### 3. éŒ¯èª¤äº‹ä»¶

ä»¥å‚³é€ \$-\sqrt{E\_b}\$ ç‚ºä¾‹ï¼ŒéŒ¯èª¤æ¢ä»¶ï¼š
$n > \sqrt{E_b}$

å› æ­¤éŒ¯èª¤æ©Ÿç‡ï¼š
$P_b = P(n > \sqrt{E_b})$

#### 4. æ¨™æº–åŒ–é«˜æ–¯è®Šæ•¸

å·²çŸ¥ \$n \sim \mathcal{N}(0, \sigma^2)\$ï¼Œå…¶ä¸­ \$\sigma^2 = N\_0/2\$ã€‚
å®šç¾©æ¨™æº–å¸¸æ…‹è®Šæ•¸ï¼š
$Z = \frac{n}{\sigma}, \quad Z \sim \mathcal{N}(0,1)$

å› æ­¤ï¼š
$P(n > \sqrt{E_b}) = P\Bigg( \frac{n}{\sigma} > \frac{\sqrt{E_b}}{\sigma} \Bigg)$

#### 5. ä»£å…¥ \$\sigma = \sqrt{N\_0/2}\$

$\frac{\sqrt{E_b}}{\sigma} = \frac{\sqrt{E_b}}{\sqrt{N_0/2}} = \sqrt{\tfrac{2E_b}{N_0}}$

æ‰€ä»¥ï¼š
$P(n > \sqrt{E_b}) = P(Z > \sqrt{\tfrac{2E_b}{N_0}})$

#### 6. Q-function å®šç¾©

$Q(x) = P(Z > x) = \frac{1}{\sqrt{2\pi}} \int_x^\infty e^{-t^2/2} dt$

å› æ­¤ï¼š
$P_b = Q\Big(\sqrt{\tfrac{2E_b}{N_0}}\Big)$

#### 7. Q-function èˆ‡ erfc çš„é—œä¿‚

äº’è£œèª¤å·®å‡½æ•¸ (erfc) å®šç¾©ï¼š
$\text{erfc}(x) = \frac{2}{\sqrt{\pi}} \int_x^\infty e^{-t^2} dt$

å…©è€…é—œä¿‚ï¼š
$Q(x) = \tfrac{1}{2} \ \text{erfc}\Big(\tfrac{x}{\sqrt{2}}\Big)$

ä»£å…¥ \$x = \sqrt{\tfrac{2E\_b}{N\_0}}\$ï¼š
$P_b = \tfrac{1}{2} \ \text{erfc}\Big(\sqrt{\tfrac{E_b}{N_0}}\Big)$

### âœ… çµè«–

BPSK åœ¨ AWGN é€šé“ä¸‹çš„éŒ¯èª¤æ©Ÿç‡ï¼š
$P_b = Q\Big(\sqrt{\tfrac{2E_b}{N_0}}\Big)$
æˆ–ç­‰åƒ¹å¯«æˆï¼š
$P_b = \tfrac{1}{2}\\text{erfc}\Big(\sqrt{\tfrac{E_b}{N_0}}\Big)$

---

## Code
```matlab
%---------------------å…ˆå®£å‘Šé¡Œç›®æ‰€éœ€çš„æ¢ä»¶----------------------------%
clear all; close all; clc;
M = 64;                 % Number of FFT points
sc = 52;                % Number of data sub-carriers
ofdmbit = 52;           % Number of bits per OFDM symbol
                        % ç”±æ–¼æ˜¯ä½¿ç”¨BPSKä¾†èª¿è®Šï¼Œå› æ­¤BPSKçš„sub-carrierä¹Ÿæ˜¯52
Nsymbol = 100;          % Number of symbols

%---------------------ä½¿ç”¨BPSK symbolé€²è¡Œèª¿è®Š--------------------------%
Data = randi([0,1], ofdmbit*Nsymbol,1);   % ç”¢ç”Ÿéš¨æ©Ÿbits
dk   = 2*Data - 1;                        % BPSKèª¿è®Š: 0â†’-1, 1â†’+1
dk_sym = reshape(dk, sc, Nsymbol);        % Serial â†’ Parallel

% æŠŠ subcarrier æ”¾å…¥é¡Œç›®æ‰€çµ¦çš„ data subcarrier
% æ³¨æ„åœ¨ data subcarrier ä¸Š 32 èˆ‡ 34 ä¹‹é–“æ²’æœ‰ç¬¬ 33 è™Ÿ sub-carrier
Dk = zeros(M, Nsymbol);
Dk(7:32, :)  = dk_sym(1:26, :);
Dk(34:59, :) = dk_sym(27:52, :);

%--------------------- M-point IDFT (è½‰æ›åˆ°æ™‚åŸŸ) -----------------------%
IDFT = [];
for i = 1:Nsymbol
    IDFT = [IDFT ifft(Dk(:, i), M)];
end

%--------------------- adding 16 samples (Cyclic prefix) ----------------%
D_cp = zeros(M+16, Nsymbol);
D_cp(1:16, :)   = IDFT(49:64, :);
D_cp(17:80, :)  = IDFT(1:64, :);

%--------------------- receiving signal z[n] = x[n]*h[n] + n[n] ---------%
h = 1;

%--------------------- parallel to serial conversion --------------------%
x_n = reshape(D_cp, 1, (M+16)*Nsymbol);
xh  = conv(x_n, h);

%--------------------- awgn addition ------------------------------------%
Eb = mean(abs(x_n).^2);
for Eb_N0 = 0:2:8
    % theoretical BER
    BPSK_Pb(Eb_N0/2+1) = 0.5*erfc(sqrt(10^(Eb_N0/10)));

    Np = Eb * 10^(-(Eb_N0/10));
    ns = sqrt((64/52)*Np/2) * (randn(1,length(D_cp(:,:))*Nsymbol) ...
       + 1i*randn(1,length(D_cp(:,:))*Nsymbol));
    z_nxh = xh(1:end) + ns;

    %----------------- cyclic prefix removal ----------------------------%
    receiver = reshape(z_nxh, 80, Nsymbol);
    rn = receiver(17:end, :);

    %----------------- M-point DFT -------------------------------------%
    DFT = [];
    for i = 1:Nsymbol
        DFT = [DFT fft(rn(:, i), M)];
    end

    %----------------- pass through equalizer --------------------------%
    Yk64 = [DFT(7:32,:) ; DFT(34:59,:)];
    Yk52 = [Yk64(:,1).' Yk64(:,2).'].' ;

    %----------------- scatterplot (Before Equalizer) ------------------%
    scatterplot(Yk52);

    H_n = fft(h, M);
    Dk = [];
    for i = 1:Nsymbol
        Dk = [Dk DFT(:, i)./H_n.'];
    end
    Dkreceiver = [Dk(7:32,:) ; Dk(34:59,:)];

    %----------------- serial to parallel conversion -------------------%
    Dkr  = reshape(Dkreceiver, 1, ofdmbit*Nsymbol);
    Dkre = sign(real(Dkr));

    ber(Eb_N0/2+1) = length(find(Dkre ~= dk)) / (52*Nsymbol);
end

%----------------- ç•« BER æ›²ç·š ------------------------------------------%
semilogy((0:2:8), ber, 'r-o');
hold on;
semilogy((0:2:8), BPSK_Pb, 'b-*');
hold on;
grid on;
title('Bit error probability curve for BPSK using OFDM');
xlabel('E_b/N_0 (dB)');
ylabel('BER');
legend('Simulation BER','Theoretical BER');

%----------------- scatterplot (After Equalizer) -----------------------%
scatterplot(Dkr(1,1:104));
```

---
## 1. AWGN
```matlab
Eb = mean(abs(x_n).^2);
for Eb_N0 = 0:2:8
    % theoretical BER
    BPSK_Pb(Eb_N0/2+1) = 0.5*erfc(sqrt(10^(Eb_N0/10)));

    Np = Eb * 10^(-(Eb_N0/10));
    ns = sqrt((64/52)*Np/2) * (randn(1,length(D_cp(:,:))*Nsymbol) ...
       + 1i*randn(1,length(D_cp(:,:))*Nsymbol));
    z_nxh = xh(1:end) + ns;
```

---

### 1.1 Eb

ç¨‹å¼é€è¡Œè§£é‡‹

```matlab
Eb = mean(abs(x_n).^2);
```

* `x_n` æ˜¯ç™¼é€ç«¯ OFDM è¨Šè™Ÿï¼ˆIFFT + CP å¾Œå±•å¹³çš„ä¸€ç¶­è¨Šè™Ÿï¼‰ã€‚
* `abs(x_n).^2`ï¼šæ¯å€‹å–æ¨£é»çš„èƒ½é‡ã€‚
* `mean(...)`ï¼šå–å¹³å‡èƒ½é‡ã€‚
* åœ¨ BPSK ä¸‹ï¼Œé€™ç­‰æ•ˆæ–¼ **æ¯ bit èƒ½é‡ \$E\_b\$**ã€‚

---

```matlab
for Eb_N0 = 0:2:8
```

* è¨­å®šæ¨¡æ“¬çš„ \$E\_b/N\_0\$ æ¸¬è©¦ç¯„åœï¼š0, 2, 4, 6, 8 dBã€‚
* ç”¨ä¾†è§€å¯Ÿ BER éš¨ SNR çš„è®ŠåŒ–ã€‚

---
### 1.2 BPSK Pre-Knowledge 
### ğŸ”¹ BPSK ç¬¦è™Ÿèƒ½é‡èˆ‡ä¸€å€‹ bit çš„é—œä¿‚
#### 1.2.1. BPSK ç¬¦è™Ÿ = ä¸€å€‹ bit

åœ¨ BPSK (Binary Phase Shift Keying) ä¸­ï¼š

* bit = 0 â†’ \$+1\$ï¼ˆæˆ– \$+\sqrt{E\_b}\$ ï¼‰
* bit = 1 â†’ \$-1\$ï¼ˆæˆ– \$-\sqrt{E\_b}\$ ï¼‰

ğŸ‘‰ æ¯å€‹ç¬¦è™Ÿåªä»£è¡¨ **ä¸€å€‹ bit**ï¼Œä¸æ˜¯å…©å€‹ bitã€‚
ï¼ˆå°æ¯” QPSKï¼šä¸€å€‹ç¬¦è™Ÿä»£è¡¨ 2 bitsï¼Œå› ç‚ºæ˜Ÿåº§åœ–æœ‰ 4 å€‹é»ã€‚ï¼‰

---

#### 1.2.2. ç‚ºä»€éº¼å¯«æˆ Â±âˆšEbï¼Ÿ

æˆ‘å€‘å¸Œæœ›ã€Œæ¯å€‹ bit çš„èƒ½é‡ = \$E\_b\$ ã€ã€‚

èƒ½é‡å®šç¾©ï¼š
$E_b = \int_{0}^{T_b} |s(t)|^2 dt$

å‡è¨­ç¬¦è™Ÿåœ¨æ•´å€‹ bit æœŸé–“æŒ¯å¹…å›ºå®š = \$A\$ï¼š
$E_b = A^2 \cdot T_b$

è‹¥å– \$T\_b = 1\$ï¼Œå°±æœ‰ï¼š
$A^2 = E_b \quad \Rightarrow \quad A = \sqrt{E_b}$

å› æ­¤ BPSK çš„ç¬¦è™Ÿé»æ‡‰è©²æ˜¯ï¼š
$s \in \{+\sqrt{E_b}, -\sqrt{E_b}\}$

æ•™ç§‘æ›¸å¸¸ç°¡åŒ–è¨­å®š \$E\_b = 1\$ï¼Œé€™æ¨£å°±å¯«æˆ Â±1ã€‚
ğŸ‘‰ æ­¤æ™‚ Â±1 çš„èƒ½é‡ = 1ï¼Œä¹Ÿå°±æ˜¯ã€Œæ¯ bit çš„èƒ½é‡ = 1ã€ã€‚

---

#### 1.2.3. ç‚ºä»€éº¼ä¸æ˜¯å…©å€‹ bitï¼Ÿ

* BPSK åªæœ‰ **å…©å€‹ç‹€æ…‹ (Â±)**ï¼Œæ‰€ä»¥åªèƒ½è¡¨ç¤º 2 å€‹å¯èƒ½å€¼ â†’ ä¹Ÿå°±æ˜¯ **1 å€‹ bit**ã€‚
* è‹¥è¦è¡¨ç¤º 2 bits éœ€è¦ 4 å€‹é»ï¼ˆä¾‹å¦‚ QPSKï¼Œæ˜Ÿåº§åœ–åœ¨å››è±¡é™ï¼‰ã€‚

### 1.2. âœ… ç¸½çµ

* BPSKï¼šä¸€å€‹ç¬¦è™Ÿ = 1 å€‹ bitï¼Œç¬¦è™Ÿé» = Â±âˆšEbã€‚
* è‹¥ \$E\_b = 1\$ï¼Œå‰‡ç¬¦è™Ÿé» = Â±1ã€‚
* Â±1 ä¸¦ä¸æ˜¯å…©å€‹ bitï¼Œè€Œæ˜¯ **åŒä¸€å€‹ bit çš„å…©ç¨®å¯èƒ½å€¼**ã€‚

---

### 1.2.4 BPSK åœ¨ AWGN ä¸‹çš„ç†è«– BER

åœ¨ **AWGN é€šé“**ä¸‹ï¼ŒBPSK çš„éŒ¯èª¤ç‡å…¬å¼ç‚ºï¼š

(i). **ç³»çµ±æ¨¡å‹**ï¼š

   * å‚³é€ bit = 0 â†’ \$+\sqrt{E\_b}\$
   * å‚³é€ bit = 1 â†’ \$-\sqrt{E\_b}\$
   * æ¥æ”¶ç«¯ï¼š
     
     $y = \pm\sqrt{E_b} + n, \quad n \sim \mathcal{N}(0, N_0/2)$

(ii). **éŒ¯èª¤æ©Ÿç‡**ï¼š

   ä½¿ç”¨é›¶é–€æª»åˆ¤æ±ºï¼ŒéŒ¯èª¤ç‡ç‚ºï¼š
   
   $P_b = Q\left(\sqrt{\tfrac{2E_b}{N_0}}\right)$

(iii). **Q-function èˆ‡ erfc çš„é—œä¿‚**ï¼š
   
   $Q(x) = \tfrac{1}{2}\,\text{erfc}\left(\tfrac{x}{\sqrt{2}}\right)$

   å› æ­¤ï¼š
   
   $P_b = \tfrac{1}{2}\,\text{erfc}\left(\sqrt{\tfrac{E_b}{N_0}}\right)$

---

### ğŸ”¹ MATLAB ç¨‹å¼å°æ‡‰

```matlab
% theoretical BER
BPSK_Pb(Eb_N0/2+1) = 0.5*erfc(sqrt(10^(Eb_N0/10)));
```

* `10^(Eb_N0/10)`ï¼šæŠŠ dB è½‰æ›æˆç·šæ€§æ¯”ä¾‹ã€‚
* `sqrt(...)`ï¼šè¨ˆç®— \$\sqrt{E\_b/N\_0}\$ ã€‚
* `erfc(...)`ï¼šäº’è£œèª¤å·®å‡½æ•¸ï¼Œå°æ‡‰å…¬å¼ã€‚
* `0.5*erfc(...)`ï¼šå°æ‡‰ \$P\_b = \tfrac{1}{2},\text{erfc}(\sqrt{E\_b/N\_0})\$ ã€‚

---

### ç‚ºä»€éº¼å¯« `BPSK_Pb(Eb_N0/2+1)`ï¼Ÿ

è¿´åœˆè¨­å®šï¼š

```matlab
for Eb_N0 = 0:2:8
```

* `Eb_N0` ä»£è¡¨çœŸå¯¦çš„ SNR(dB)ï¼š0, 2, 4, 6, 8ã€‚
* MATLAB é™£åˆ—ç´¢å¼• **ä¸èƒ½å¾ 0 é–‹å§‹**ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ç”¨ `BPSK_Pb(Eb_N0)`ã€‚

è§£æ³•ï¼š

* é™¤ä»¥ 2ï¼šæŠŠ {0,2,4,6,8} â†’ {0,1,2,3,4}
* å† +1ï¼šè®Šæˆ {1,2,3,4,5}

é€™æ¨£å‰›å¥½å°æ‡‰é™£åˆ—ç´¢å¼•ï¼Œçµæœå­˜åœ¨ `BPSK_Pb(1:5)` è£¡ã€‚


---
### 1.2.5 Np

```matlab
Np = Eb * 10^(-(Eb_N0/10));
```

* æ ¹æ“šå…¬å¼ :
  
$$
\frac{E_b}{N_0} = 10^{\tfrac{(E_b/N_0)_{dB}}{10}}
$$

è¨ˆç®— **é›œè¨ŠåŠŸç‡**ã€‚
* åœ¨é€™è£¡ `Np` ä»£è¡¨ AWGN çš„å¹³å‡åŠŸç‡ã€‚

---
### 1.2.6. AWGN
```matlab
% ... ä»£è¡¨ çºŒè¡Œç¬¦è™Ÿ (line continuation)ã€‚
ns = sqrt((64/52)*Np/2) * (randn(1,length(D_cp(:,:))*Nsymbol) ...
       + 1i*randn(1,length(D_cp(:,:))*Nsymbol));
```

#### ğŸ”¹ 1.2.6.1. AWGN çš„ç†è«–

åœ¨ **è¤‡æ•¸åŸºé »æ¨¡å‹**è£¡ï¼Œè‹¥å¸Œæœ›å¹³å‡é›œè¨ŠåŠŸç‡ = \$N\_p\$ï¼š
$\mathbb{E}[|n|^2] = N_p$

å› ç‚º \$n = n\_r + j n\_i\$ï¼Œå…¶ä¸­ï¼š

* \$n\_r \sim \mathcal{N}(0,\sigma^2)\$
* \$n\_i \sim \mathcal{N}(0,\sigma^2)\$

æ‰€ä»¥ï¼š
$\mathbb{E}[|n|^2] = \mathbb{E}[n_r^2] + \mathbb{E}[n_i^2] = 2\sigma^2$

ä»¤ \$2\sigma^2 = N\_p\$ï¼Œå¾—åˆ°ï¼š
$\sigma^2 = \tfrac{N_p}{2}$

å› æ­¤ï¼š
$n = \sqrt{\tfrac{N_p}{2}} (X + jY), \quad X,Y \sim \mathcal{N}(0,1)$

é€™å°±æ˜¯ã€Œè¤‡æ•¸ AWGN çš„ç”¢ç”Ÿæ–¹å¼ã€ã€‚

---

####  ğŸ”¹ 1.2.6.2. åŸç¨‹å¼ç¢¼

```matlab
ns = sqrt((64/52)*Np/2) * (randn(...) + 1i*randn(...));
```

é€™è£¡ä¹˜ä¸Šçš„ä¿‚æ•¸æ˜¯ï¼š
$\sqrt{\tfrac{(64/52)N_p}{2}}$

æ›å¥è©±èªªï¼Œå®ƒç”¢ç”Ÿçš„é›œè¨ŠåŠŸç‡æ˜¯ï¼š
$\mathbb{E}[|ns|^2] = (64/52)N_p$

---

#### ğŸ”¹ 1.2.6.3. ç‚ºä»€éº¼å¤šäº†ä¸€å€‹ (64/52)ï¼Ÿ

é€™å…¶å¯¦æ˜¯ **OFDM ç‰¹æœ‰çš„ scaling**ï¼Œä¸¦ä¸æ˜¯éŒ¯ã€‚

åŸå› ï¼š

* åœ¨ä¸€å€‹ OFDM symbol è£¡ï¼Œç”¨äº† **64 å€‹ FFT é»**ï¼Œä½†åªæœ‰ **52 å€‹å­è¼‰æ³¢æ‰¿è¼‰è³‡æ–™**ã€‚
* è‹¥ç”¨ã€Œæ¯ bit èƒ½é‡ \$E\_b\$ã€ä¾†å®šç¾© SNRï¼Œå¹³å‡åˆ° 64 é»å¾Œï¼Œå¯¦éš›æœ‰æ•ˆèƒ½é‡è®Šå°ã€‚
* å› æ­¤è¦æŠŠé›œè¨ŠåŠŸç‡ä¹˜ä¸Š \$(64/52)\$ï¼Œç¢ºä¿æ¨¡æ“¬çš„ **\$E\_b/N\_0\$ å®šç¾©æ­£ç¢º**ã€‚


---
### 1.2.7. Z[n]
```matlab
z_nxh = xh(1:end) + ns;
```

* `xh`ï¼šé€šéé€šé“çš„è¨Šè™Ÿ (é€™è£¡ h=1ï¼Œæ‰€ä»¥ç›¸ç•¶æ–¼åŸå§‹è¨Šè™Ÿ)ã€‚
* `ns`ï¼šç”Ÿæˆçš„ AWGNã€‚
* å…©è€…ç›¸åŠ  â†’ æ¥æ”¶ç«¯è¨Šè™Ÿ `z_nxh`ã€‚



