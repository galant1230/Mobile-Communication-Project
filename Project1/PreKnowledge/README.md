## Jakes Model 介紹

### 1. 背景

* 在無線通訊中，**Rayleigh fading** 常用來描述多路徑傳播且無直視徑 (NLOS) 的情況。
* 但要在電腦中模擬 Rayleigh fading，需要一個能產生 **時間相關的隨機信號** 的方法。
* **Jakes Model**（又稱 Clarke’s Model）就是一個經典方法，用來數值模擬 Rayleigh fading 通道。

---

### 2. 基本原理

* Rayleigh fading 的時間變化來自於 **多普勒效應**。
* 假設有很多個平面波 (incoming waves)，從不同角度到達接收機，且角度均勻分佈。
* 每個波會帶有不同的相位與頻率偏移，疊加後形成接收信號：

$$
T(t) = E_0 \sum_{m=1}^N C_m e^{j(\cos \alpha_m \, \omega_d t + \phi_m)}
$$

其中：

* \$N\$：等效波的數量 (通常取 30 足夠)
* \$C\_m\$：歸一化權重 (\$C\_m^2 = 1/N\$)
* \$\alpha\_m\$：角度，假設均勻分佈
* \$\omega\_d = 2\pi f\_d\$：最大多普勒頻率
* \$\phi\_m\$：隨機初始相位

---

### 3. 模擬步驟

1. 設定 **載波頻率** \$f\_c\$ 與 **移動速度** \$v\$ → 決定波長 \$\lambda = c/f\_c\$ 與最大多普勒頻移 \$f\_d = v/\lambda\$。
2. 選擇模擬長度與取樣間隔 \$\Delta t\$。
3. 產生 \$N\$ 個等效波，每個有不同角度與隨機相位。
4. 疊加這些波形成複數過程 \$h(t)\$。
5. \$|h(t)|\$ 的統計分佈應符合 **Rayleigh 分佈**。

---

### 4. 特點

* Jakes Model 可以生成 **時間相關 (time-correlated)** 的 Rayleigh fading，而不是獨立樣本。
* 可以模擬 **多普勒效應**，反映移動通訊中的快衰落現象。
* 擴展後也能模擬 **Rician fading**（在疊加一個 LOS 分量）。

---

### 5. 實務應用

* 用於 **模擬無線通道**，例如：

  * 行動通訊 (LTE, 5G)
  * 衛星通訊
  * 無線感測器網路
* 在研究中常用來 **驗證理論 PDF** 與 **測試通道編碼/調變效能**。

---

## Jakes Model 與 Rayleigh Fading

### 1. Jakes Model 簡介

* **用途**：用於模擬移動通訊中的 **時間相關 Rayleigh 衰落**。

* **核心想法**：

  * 把接收信號看成許多不同角度的平面波疊加。
  * 每個平面波因為移動造成 **多普勒效應**，頻率略有偏移。
  * 疊加後形成一個隨機但有時間相關性的信號。

* **數學模型**：

$$
T(t) = E_0 \sum_{m=1}^N C_m e^{j(\cos \alpha_m \, \omega_d t + \phi_m)}
$$

  * \$N\$：平面波數目（通常取 30 即可近似）
  * \$C\_m\$：權重 (\$C\_m^2 = 1/N\$)
  * \$\alpha\_m\$：到達角度，假設均勻分佈
  * \$\omega\_d = 2\pi f\_d\$：最大多普勒頻率
  * \$\phi\_m\$：隨機初始相位

---

### 2. Rayleigh Fading 簡介

* **定義**：在無直視徑 (NLOS) 環境中，接收到的信號是眾多散射徑的疊加。
* **統計特性**：

  * I/Q 分量 ( \$n\_I(t), n\_Q(t)\$ ) → 高斯分佈
  * 相位：均勻分佈於  $\[-\pi, \pi]\$
  * 包絡：
    
$|h(t)| = \sqrt{n_I^2 + n_Q^2}$

    → **Rayleigh 分佈**

---

### 3. Rayleigh 分佈介紹

* **Rayleigh 分佈定義**：若隨機變數 \$X, Y\$ 彼此獨立且服從 \$N(0, \sigma^2)\$，則：
  $R = \sqrt{X^2 + Y^2}$
  服從 Rayleigh 分佈。

* **機率密度函數 (PDF)**：
  
  $f_R(r) = \frac{r}{\sigma^2} e^{-r^2/(2\sigma^2)}, \quad r \geq 0$

* **性質**：

  * 均值： \$E\[R] = \sigma \sqrt{\pi/2}\$
  * 方差： \$Var\[R] = (2 - \pi/2)\sigma^2\$
  * 常用於描述無 LOS 的無線通道包絡。

* **應用場景**：

  * 城市、室內環境，訊號被多次散射，沒有直視路徑。

---

### 4. 為什麼 Jakes Model 能模擬 Rayleigh Fading？

1. **隨機性來源**：

   * 每個入射波的角度與相位隨機 → 疊加後滿足中心極限定理。
   * 結果：I/Q 分量呈現高斯分佈。

2. **時間相關性來源**：

   * 多普勒效應造成相位隨時間變化。
   * \$h(t)\$ 不只是獨立樣本，而是**時間相關的隨機過程**。

3. **統計一致性**：

   * 包絡 \$|h(t)|\$ 的分佈符合 Rayleigh。
   * 相位服從均勻分佈。
   * 自相關函數與理論 Rayleigh fading 一致。

---

✅ **總結**：

* **Rayleigh fading** 描述的是「無 LOS 的通道隨機特性」，其包絡符合 Rayleigh 分佈。
* **Jakes Model** 則提供一種數值方法，用有限數目的隨機平面波疊加來模擬該通道。
* 因此，Jakes Model 可以產生時間相關、統計特性正確的 Rayleigh fading 信號。

