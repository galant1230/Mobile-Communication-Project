# Rayleigh åˆ†ä½ˆå¾é«˜æ–¯ï¼ˆNLOS å¤šè·¯å¾‘ï¼‰æ¨å°

## 0. ç‰©ç†å‡è¨­ï¼ˆç‚ºä»€éº¼æ˜¯ Rayleighï¼Ÿï¼‰
åœ¨ **NLOS** çš„ç’°å¢ƒä¸­ï¼Œæ¥æ”¶ç«¯çœ‹åˆ°çš„ç­‰æ•ˆé€šé“ï¼ˆæˆ–é›œè¨Šï¼‰å¯ä»¥è¦–ç‚ºè¨±å¤šæ•£å°„è·¯å¾‘çš„å‘é‡ç–ŠåŠ ï¼š
- è·¯å¾‘å¾ˆå¤šä¸”å½¼æ­¤ç¨ç«‹ï¼›
- æ¯æ¢è·¯å¾‘çš„åˆ°é”ç›¸ä½è¿‘ä¼¼ **å‡å‹»åˆ†ä½ˆ**ï¼ˆ $[0,2\pi)$ ï¼‰ï¼›
- æ²’æœ‰ã€Œç‰¹åˆ¥å¼·ã€çš„ä¸»å°ç›´è¦–å¾‘ï¼ˆ**æ²’æœ‰ LOS**ï¼‰ï¼ŒåŠŸç‡ç”±çœ¾å¤šè·¯å¾‘åˆ†æ”¤ã€‚

åœ¨æ­¤æ¢ä»¶ä¸‹ï¼Œ**åŒç›¸/æ­£äº¤**åˆ†é‡ï¼ˆI/Qï¼‰æœƒå› ä¸­å¿ƒæ¥µé™å®šç†è¶¨è¿‘ **é›¶å‡å€¼é«˜æ–¯**ï¼›å…¶åŒ…çµ¡ï¼ˆåˆ°åŸé»çš„è·é›¢ï¼‰è‡ªç„¶å‘ˆ **Rayleigh**ã€‚

---

## 1. æ•¸å­¸æ¨¡å‹ï¼ˆå¾ NLOS å¤šè·¯å¾‘åˆ° I/Q é«˜æ–¯ï¼‰
ä»¤ç­‰æ•ˆè¤‡æ•¸é€šé“ï¼ˆæˆ–è¤‡æ•¸é›œè¨Šï¼‰åœ¨æŸä¸€å€‹å›ºå®šæ™‚é–“æˆªé¢ç‚º

$$
h \=\ \sum_{k=1}^{L} a_k e^{j\phi_k} \=\ X + jY,
$$

å…¶ä¸­ $a_k \ge 0$ ç‚ºç¬¬ $k$ æ¢è·¯å¾‘çš„æŒ¯å¹…ï¼Œ $\phi_k \sim \text{Unif}(0,2\pi)$ ä¸”ç›¸äº’ç¨ç«‹ï¼Œ $L$ å¾ˆå¤§ã€‚

æŠŠå¯¦éƒ¨èˆ‡è™›éƒ¨åˆ†é–‹ï¼š

$$
X \=\ \sum_{k=1}^{L} a_k \cos\phi_k, 
\qquad
Y \=\ \sum_{k=1}^{L} a_k \sin\phi_k.
$$

å› ç‚º $\phi_k$ å‡å‹»ä¸”èˆ‡ $a_k$ ç¨ç«‹ï¼Œæœ‰

$$
\mathbb{E}[\cos\phi_k] = \mathbb{E}[\sin\phi_k] = 0,\qquad
\mathbb{E}[\cos\phi_k\sin\phi_k]=0,
$$

ä¸”

$$
\mathbb{E}[\cos^2\phi_k] = \mathbb{E}[\sin^2\phi_k] = \frac{1}{2}.
$$

---
### ç‚ºä»€éº¼ \$\mathbb{E}\[\cos^2\phi\_k] = \mathbb{E}\[\sin^2\phi\_k] = \tfrac{1}{2}\$

å‡è¨­ \$\phi\_k \sim \text{Unif}(0,2\pi)\$ã€‚

#### 1. ä½¿ç”¨ä¸‰è§’æ†ç­‰å¼

$$
\cos^2\phi = \tfrac{1}{2}(1+\cos 2\phi), \qquad
\sin^2\phi = \tfrac{1}{2}(1-\cos 2\phi).
$$

#### 2. å°å‡å‹»åˆ†ä½ˆå–æœŸæœ›

$$
\mathbb{E}[\cos^2\phi]
= \frac{1}{2\pi}\int_0^{2\pi}\cos^2\phi \, d\phi,
$$

$$
\mathbb{E}[\sin^2\phi]
= \frac{1}{2\pi}\int_0^{2\pi}\sin^2\phi \, d\phi.
$$

ä»£å…¥æ†ç­‰å¼ï¼š

$$
\mathbb{E}[\cos^2\phi]
= \frac{1}{2\pi}\int_0^{2\pi}\tfrac{1}{2}(1+\cos 2\phi)\, d\phi.
$$

æ‹†æˆå…©é …ï¼š

$$
= \tfrac{1}{2}\cdot \frac{1}{2\pi}\int_0^{2\pi}1\, d\phi + 
 \tfrac{1}{2}\cdot \frac{1}{2\pi}\int_0^{2\pi}\cos 2\phi\, d\phi.
$$

å› ç‚º

$$
\int_0^{2\pi}\cos 2\phi \, d\phi = 0,
$$

æ‰€ä»¥ï¼š

$$
\mathbb{E}[\cos^2\phi] = \tfrac{1}{2}.
$$

åŒç†ï¼š

$$
\mathbb{E}[\sin^2\phi] = \tfrac{1}{2}.
$$


#### 3. çµæœ

å› æ­¤ï¼š

$$
\mathbb{E}[\cos^2\phi_k] = \mathbb{E}[\sin^2\phi_k] = \tfrac{1}{2}.
$$

ğŸ‘‰ ç›´è§€ä¸Šï¼Œå› ç‚º \$\phi\$ åœ¨ $\[0,2\pi)\$ ä¸Šå‡å‹»åˆ†ä½ˆï¼Œå¹³å‡ä¾†çœ‹ï¼Œ \$\cos^2\$ å’Œ \$\sin^2\$ åˆ†åˆ¥ä½”ä¸€åŠçš„èƒ½é‡ã€‚

---

å› æ­¤

$$
\mathbb{E}[X]=\mathbb{E}[Y]=0,
$$

$$
\mathrm{Var}(X)=\sum_{k=1}^{L}\mathbb{E}[a_k^2]\cdot \mathbb{E}[\cos^2\phi_k]
= \tfrac{1}{2}\sum_{k=1}^{L}\mathbb{E}[a_k^2],
$$

$$
\mathrm{Var}(Y)=\tfrac{1}{2}\sum_{k=1}^{L}\mathbb{E}[a_k^2],
\qquad
\mathrm{Cov}(X,Y)=0.
$$

ç•¶ $L$ å¾ˆå¤§ï¼ˆè¨±å¤šç¨ç«‹å°è²¢ç»ï¼‰ï¼Œç”±**ä¸­å¿ƒæ¥µé™å®šç†**å¯å¾—

$$
X \sim \mathcal N(0,\sigma^2),\qquad Y \sim \mathcal N(0,\sigma^2),\qquad
\sigma^2 \=\ \frac{1}{2}\sum_{k=1}^{L}\mathbb{E}[a_k^2],
$$

ä¸” $X$ èˆ‡ $Y$ ç¨ç«‹åŒåˆ†ä½ˆã€‚é€™ç¨±ç‚º**åœ“å°ç¨±è¤‡é«˜æ–¯**ï¼ˆCSCGï¼‰éš¨æ©Ÿè®Šæ•¸ã€‚

---

## 2. ç”± I/Q é«˜æ–¯æ¨å°åŒ…çµ¡çš„ Rayleigh åˆ†ä½ˆï¼ˆåº§æ¨™è½‰æ›ï¼‰
å®šç¾©åŒ…çµ¡èˆ‡ç›¸ä½ï¼š

$$
R = \sqrt{X^2+Y^2},\qquad \Theta=\mathrm{atan2}(Y,X).
$$

å›  $X,Y$ ç¨ç«‹ä¸”åŒç‚º $\mathcal N(0,\sigma^2)$ï¼Œå…¶è¯åˆå¯†åº¦ç‚º

$$
f_{X,Y}(x,y)=\frac{1}{2\pi\sigma^2}\exp\\left(-\frac{x^2+y^2}{2\sigma^2}\right).
$$

---
### ç‚ºä»€éº¼å«ã€ŒäºŒç¶­åœ“å°ç¨±é«˜æ–¯ã€ï¼Ÿ

æˆ‘å€‘çš„è¯åˆåˆ†ä½ˆæ˜¯ï¼š

$$
f_{X,Y}(x,y) = \frac{1}{2\pi\sigma^2} \exp\!\left(-\frac{x^2+y^2}{2\sigma^2}\right).
$$

#### è§€å¯Ÿé‡é»

* æŒ‡æ•¸é …åªè·Ÿ \$x^2+y^2\$ æœ‰é—œï¼Œä¹Ÿå°±æ˜¯ã€Œåˆ°åŸé»çš„è·é›¢å¹³æ–¹ã€ï¼š

$$
r^2 = x^2+y^2.
$$

* æ‰€ä»¥åªè¦åŠå¾‘ \$r\$ ä¸€æ¨£ï¼Œå¯†åº¦å€¼å°±ä¸€æ¨£ã€‚
* ç­‰æ©Ÿç‡å¯†åº¦çš„æ›²ç·šæ»¿è¶³ï¼š

$$
x^2+y^2=c \quad (\text{å¸¸æ•¸}).
$$

* é€™æ­£æ˜¯ä¸€å€‹ã€Œä»¥åŸé»ç‚ºåœ“å¿ƒçš„åœ“ã€ã€‚

#### çµè«–

å› æ­¤å®ƒæ˜¯ **åœ“å°ç¨± (circularly symmetric)** çš„äºŒç¶­é«˜æ–¯åˆ†ä½ˆã€‚

### ASCII åœ“ç’°ç¤ºæ„

```text
          y
          â†‘
      *********
    **         **
   *             *
   *      â—      *+----------------â†’ x   â† ç­‰å¯†åº¦åœ“ (xÂ²+yÂ² = câ‚)
   *             *
    **         **
      *********

    ***************
  **               **
 *                   *
 *        â—          *   â† æ›´å¤§ä¸€åœˆç­‰å¯†åº¦åœ“ (xÂ²+yÂ² = câ‚‚ > câ‚)
 *                   *
  **               **
    ***************

```

ğŸ‘‰ æ¯ä¸€åœˆéƒ½æ˜¯ \$x^2+y^2=c\$ çš„ç­‰å¯†åº¦ç·šï¼ŒåŠå¾‘è¶Šå¤§ï¼Œæ©Ÿç‡å¯†åº¦è¶Šå°ã€‚

---

æ”¹æˆæ¥µåº§æ¨™ï¼ˆ $x=r\cos\theta,\, y=r\sin\theta$ï¼Œ $r\ge0, \theta\in(-\pi,\pi]$ ï¼‰ï¼ŒJacobian ç‚º

$$
\left|\frac{\partial(x,y)}{\partial(r,\theta)}\right| = r.
$$

å› æ­¤

$$
f_{R,\Theta}(r,\theta)
= f_{X,Y}(x,y)\cdot r
= \frac{1}{2\pi\sigma^2}\exp\\left(-\frac{r^2}{2\sigma^2}\right)\ r.
$$

é‚Šéš›åŒ–æ‰ $\Theta$ï¼š

$$
f_R(r) = \int_{-\pi}^{\pi} f_{R,\Theta}(r,\theta)\, d\theta
= \frac{r}{\sigma^2}\exp\\left(-\frac{r^2}{2\sigma^2}\right),\qquad r\ge 0.
$$

é€™å°±æ˜¯ **Rayleigh åˆ†ä½ˆ** çš„ PDFï¼š

$$
\boxed{\, f_R(r) \;=\; \dfrac{r}{\sigma^2}\, e^{-\,r^2/(2\sigma^2)},\quad r\ge0 \, }.
$$

å…¶ CDFã€å‡å€¼ã€æ–¹å·®åˆ†åˆ¥ç‚º

$$
F_R(r)=1-\exp\\left(-\frac{r^2}{2\sigma^2}\right),\quad r\ge0,
$$

$$
\mathbb{E}[R]=\sigma\sqrt{\tfrac{\pi}{2}},\qquad
\mathrm{Var}(R)=\left(2-\tfrac{\pi}{2}\right)\sigma^2.
$$

---

## 3. å¦ä¸€ç¨®æ¥µç°¡è§€é»ï¼š$\chi^2$ / æŒ‡æ•¸
ç”±æ–¼

$$
\frac{X^2}{\sigma^2} + \frac{Y^2}{\sigma^2} \;\sim\; \chi^2_{(2)},
$$

ç­‰åƒ¹æ–¼ä¸€å€‹åƒæ•¸ç‚º $\lambda=\tfrac{1}{2}$ çš„æŒ‡æ•¸åˆ†ä½ˆï¼Œå› æ­¤

$$
\frac{R^2}{\sigma^2} \sim \chi^2_{(2)}
\quad\Longrightarrow\quad
R^2 \sim \text{Exp}\!\left(\frac{1}{2\sigma^2}\right).
$$

æŠŠ $Z=R^2$ çš„æŒ‡æ•¸å¯†åº¦ $f_Z(z)=\tfrac{1}{2\sigma^2}e^{-z/(2\sigma^2)}$ï¼ˆ$z\ge0$ï¼‰åšè®Šæ•¸å›ä»£
ï¼ˆ$z=r^2,\, dz=2r\,dr$ï¼‰å³å¯åˆ°é”åŒä¸€å€‹ Rayleigh PDFã€‚

---

## 4. ç‚ºä½•å¼·èª¿ã€ŒNLOSã€ï¼Ÿ
- **NLOS** å¤šè·¯å¾‘ â‡’ è¨±å¤šéš¨æ©Ÿç›¸ä½çš„å¾®å°å‘é‡ç›¸åŠ  â‡’ $X,Y$ é›¶å‡å€¼ã€ç­‰æ–¹å·®ã€ç¨ç«‹é«˜æ–¯ â‡’ **Rayleigh åŒ…çµ¡**ã€‚
- **è‹¥å­˜åœ¨å¼· LOS**ï¼ˆæˆ–ä¸»å°å¾‘ï¼‰ï¼Œ$h$ æœƒæœ‰**éé›¶å‡å€¼**ï¼Œ$R$ çš„åˆ†ä½ˆå°±è®Šæˆ **Rician**ï¼š
  
$$
f_R(r)=\frac{r}{\sigma^2}\exp\!\left(-\frac{r^2+s^2}{2\sigma^2}\right) I_0\!\left(\frac{rs}{\sigma^2}\right),
$$

  å…¶ä¸­ $s=|\mu|$ ç‚º LOS æŒ¯å¹…ã€$I_0(\cdot)$ æ˜¯ä¿®æ­£ Bessel å‡½æ•¸ã€‚ç•¶ $s\to 0$ å°±é€€åŒ–æˆ Rayleighã€‚

---

## 5. ä¸€å¥è©±ç¸½çµ
**Rayleigh åˆ†ä½ˆ** ä¾†è‡ª **NLOS å¤šè·¯å¾‘** ä¸‹è¨±å¤šéš¨æ©Ÿç›¸ä½è·¯å¾‘å‘é‡çš„ç–ŠåŠ ï¼šI/Q ç”± **ä¸­å¿ƒæ¥µé™å®šç†** æˆç‚ºé›¶å‡å€¼ç¨ç«‹é«˜æ–¯ï¼Œæ•…å…¶åŒ…çµ¡ï¼ˆåˆ°åŸé»è·é›¢ï¼‰å¿…ç„¶æ˜¯ **Rayleigh**ã€‚
