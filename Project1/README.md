## ğŸŒŠ Jakes Model èˆ‡ Gaussian Rayleigh çš„å°æ‡‰èˆ‡å¯¦ä½œç­†è¨˜

---

### ğŸ§  ä¸»è¦ç›®çš„ï¼š

ç”¨ **Jakes model** æ¨¡æ“¬æ™‚é–“è®ŠåŒ–çš„ **Rayleigh fading**ï¼ˆå³é€šé“ä¿‚æ•¸ $h(t)$ éš¨æ™‚é–“è®ŠåŒ–çš„éš¨æ©Ÿéç¨‹ï¼‰ã€‚

### Jakes Model ç°¡ä»‹

* **ç”¨é€”**ï¼šç”¨æ–¼æ¨¡æ“¬ç§»å‹•é€šè¨Šä¸­çš„ **æ™‚é–“ç›¸é—œ Rayleigh è¡°è½**ã€‚

* **æ ¸å¿ƒæƒ³æ³•**ï¼š

  * æŠŠæ¥æ”¶ä¿¡è™Ÿçœ‹æˆè¨±å¤šä¸åŒè§’åº¦çš„å¹³é¢æ³¢ç–ŠåŠ ã€‚
  * æ¯å€‹å¹³é¢æ³¢å› ç‚ºç§»å‹•é€ æˆ **å¤šæ™®å‹’æ•ˆæ‡‰**ï¼Œé »ç‡ç•¥æœ‰åç§»ã€‚
  * ç–ŠåŠ å¾Œå½¢æˆä¸€å€‹éš¨æ©Ÿä½†æœ‰æ™‚é–“ç›¸é—œæ€§çš„ä¿¡è™Ÿã€‚

* **æ•¸å­¸æ¨¡å‹**ï¼š

$$
T(t) = E_0 \sum_{m=1}^N C_m e^{j(\cos \alpha_m \, \omega_d t + \phi_m)}
$$

  * \$N\$ï¼šå¹³é¢æ³¢æ•¸ç›®ï¼ˆé€šå¸¸å– 30 å³å¯è¿‘ä¼¼ï¼‰
  * \$C\_m\$ï¼šæ¬Šé‡ (\$C\_m^2 = 1/N\$)
  * \$\alpha\_m\$ï¼šåˆ°é”è§’åº¦ï¼Œå‡è¨­å‡å‹»åˆ†ä½ˆ
  * \$\omega\_d = 2\pi f\_d\$ï¼šæœ€å¤§å¤šæ™®å‹’é »ç‡
  * \$\phi\_m\$ï¼šéš¨æ©Ÿåˆå§‹ç›¸ä½
    
---

## ğŸ§ª ç‚ºä»€éº¼ Jakes æ¨¡å‹çš„ Envelope æ˜¯ Rayleighï¼Ÿ

> é€™å€‹è¤‡æ•¸ç¸½å’Œå…¬å¼é•·å¾—è·Ÿ Rayleigh åˆ†å¸ƒå¥½åƒä¸å¤ªä¸€æ¨£ï¼Œç‚ºä»€éº¼å–çµ•å°å€¼ä¹‹å¾Œå°±æœƒæ˜¯ Rayleighï¼Ÿ

è®“æˆ‘å€‘ä¸€æ­¥æ­¥è§£æï¼š

### ğŸ“Œ Step 1ï¼šJakes æ¨¡å‹å…¬å¼

$$
T(t) = E_0 \sum_{m=1}^{N} C_m e^{j(\cos \alpha_m \, \omega_d t + \phi_m)}
$$

æˆ‘å€‘é—œå¿ƒçš„æ˜¯å…¶ **envelope**ï¼š

$$
|T(t)| = \left| \sum_{m=1}^N C_m e^{j(\cos \alpha_m \omega_d t + \phi_m)} \right|
$$

---

### ğŸ“Œ Step 2ï¼šè½‰æ›ç‚ºå¯¦éƒ¨èˆ‡è™›éƒ¨çš„ç¸½å’Œ

åˆ©ç”¨æ­æ‹‰å…¬å¼ï¼š

$$
e^{j\theta} = \cos(\theta) + j \sin(\theta)
$$

æ‰€ä»¥ç¸½å’Œè®Šæˆï¼š

$$
T(t) = \sum C_m \cos(\psi_m(t)) + j \sum C_m \sin(\psi_m(t))
$$

å…¶ä¸­ $\psi_m(t) = \cos \alpha_m \, \omega_d t + \phi_m$

---

### ğŸ“Œ Step 3ï¼šä¸­å¿ƒæ¥µé™å®šç†ï¼ˆCLTï¼‰æ‡‰ç”¨

è‹¥ï¼š

* $\phi_m \sim \text{Uniform}(0,2\pi)$
* $\alpha_m$ å¤šæ–¹å‘åˆ†å¸ƒ â†’ å°æ‡‰ä¸åŒ Doppler
* $C_m = 1/\sqrt{N}$ï¼ˆæˆ–å¸¸æ•¸ï¼‰

å‰‡ï¼š

* $\text{Re}(T(t)) \sim \mathcal{N}(0,\sigma^2)$
* $\text{Im}(T(t)) \sim \mathcal{N}(0,\sigma^2)$

å› ç‚ºæ˜¯å¾ˆå¤šç¨ç«‹å°åˆ†é‡çš„ç¸½å’Œï¼Œæ ¹æ“šä¸­å¿ƒæ¥µé™å®šç†æœƒè¶¨è¿‘ Gaussianï¼

---

### ğŸ“Œ Step 4ï¼šè¤‡æ•¸ Gaussian å–çµ•å°å€¼æœƒè®Šæˆ Rayleigh

$$
|T(t)| = \sqrt{\text{Re}(T(t))^2 + \text{Im}(T(t))^2} \sim \text{Rayleigh}(\sigma)
$$

é€™æ­£æ˜¯ Rayleigh åˆ†å¸ƒçš„å®šç¾©ï¼šå…©å€‹ç¨ç«‹é«˜æ–¯éš¨æ©Ÿè®Šæ•¸ï¼ˆå‡å€¼ 0ï¼‰çµ„åˆæˆçš„é•·åº¦ã€‚
   
---

## ğŸ“Œ åŸå§‹ MATLAB ç¨‹å¼ç¢¼ï¼ˆJakes model + Gaussian Rayleigh å°æ¯”ï¼‰

```matlab
clc;clear;close all;
%------------------å…ˆçµ¦å®šåƒæ•¸--------------------%
T=1;                        % éŒ„æ™‚é–“é•· T=1ï¼Œè‹¥è¨­å¤ªå¤šï¼Œä¾‹å¦‚100å‰‡é›»è…¦ç„¡æ³•è² è·åœé‡
delta_t=0.000001;           % ä»¥ä¸‹ç‚ºç¸½æ™‚é–“æ‰€ä½”çš„å¾®åº¦
N=30;
f=3.5*10^9;
c=3*10^8;
Eo=sqrt(2);
v=(60000)/3600;             % å…ˆæ›æˆ(m/s)è¼ƒç‚ºå¸¸ç”¨çš„å–®ä½
landa=c/fc;
t=0:delta_t:T;              % ä»¥ä¸‹ç‚ºæ‰€ä½¿ç”¨çš„æ™‚é–“ç¯„åœ(1/m)
n=0:1:N-1;
m=0:1:N-1;
cn=msqrt(1/N);              % ä»¥ä¸‹ç‚ºbaseband representationçš„åƒæ•¸è¡¨ç¤º
w_m=(2*pi*v)/landa;
rfa_m=(2*pi*m)/N;

%------------------è¨ˆç®—Jakes's modelçš„h(t)--------------------%
for i=1:N                     % ç”¨forä¾†é‡Tisigamaé‹ç®—
    phi_m=2*pi*rand(1,1);     % ä»£è¡¨çš„æ˜¯uniform distribution
    h(i,:)=cn*exp(j*(cos(rfa_m(i))*w_m*n'+phi_m));
end
h_t=Eo*sum(h);

%------------------è¨ˆç®—Jakes's rayleigh fading pdf--------------------%
A=abs(h_t);                   % å–çµ•å°å€¼
[a_h,y]=hist(A,h_y);         % histæŒ‡ä»¤å°‡æ•´é«”è³‡æ–™ä¾é•·åº¦å¤§å°åˆ†ç‚ºçµ„ï¼Œå„çµ„ä»¶ä¸­ä¹‹æ•¸ç›®ä½œç‚ºç¹ªåœ–ä¹‹æ ¹æ“šã€‚
p_a_h=a_h./(sum(a_h)*(0.1)); % æ¯å€‹binå¯¬æ˜¯0.1 â†’ çµ±ä¸€ä¸€å€‹ç›¸ç›¸ä¹˜ [2 3].*2 [2 3 4]  æœ¬è¡Œæ˜¯è¦ç®—å¯†åº¦

%------------------å†ç®— Gaussian rayleigh fading pdf--------------------%
var=1;
c=sqrt(var/2)*(randn(1,1000000)+j*randn(1,1000000)); % ç”¢ç”Ÿä¸€èˆ¬çš„complex Gassion
a_c=abs(c);
y_c=[0:0.1:10];
[a_c_y,c_y]=hist(a_c,y_c);
p_a_c=a_c./(sum(a_c)*(0.1));

%------------------æ­¤è™•ç‚ºè¨ˆç®—å¹³å‡å€¼èˆ‡è®Šç•°æ•¸--------------------%
mean_c=mean(c);mean_h_t=mean(h_t);
var_c=std(c)^2;var_h_t=std(h_t).^2;
mean_A_c=mean(A);mean_A_h=mean(A_h);
var_A_c=std(A_c)^2;var_A_h=std(A_h).^2;

%------------------ç¹ªåœ–é¡¯ç¤º--------------------%
figure(1);
plot(y,p_a_h,'c',y_c,p_a_c,'r--');     % å°‡Gausison Rayleighä½¿ç”¨ç´…è‰²è™›ç·šè¡¨ç¤º
xlabel('h(t)/var');ylabel('P(h(t)/var)');
title('Normalized PDF of Gaussian rayleigh and Jakes rayleigh');
legend('Jakes rayleigh','Gaussian rayleigh')
axis([0 4.5 0 1])

figure(2);
hist(A,h_y);title('Histogram of Jakes rayleigh');
xlabel('frequency');
ylabel('Number of Hits');
axis([0 4.5 0 10^5])

figure(3);
hist(A_c,y_c);title('Histogram of Gaussian rayleigh');
xlabel('|y(t)|');ylabel('frequency');
axis([-0.5 4.5 0 10^5]);
```

---

### ğŸ“Œ Part 1 : åƒæ•¸

```matlab
clc; clear; close all;

%------------------å…ˆçµ¦å®šåƒæ•¸--------------------%
T = 1;                         % ç¸½æ¨¡æ“¬æ™‚é–“ Tï¼ˆç§’ï¼‰
delta_t = 0.000001;            % æ™‚é–“é–“éš” Î”tï¼ˆç§’ï¼‰ â†’ å½±éŸ¿æ™‚é–“è§£æåº¦
N = 30;                        % æ•£å°„è·¯å¾‘æ•¸ N
f = 3.5*10^9;                  % é »ç‡ fï¼ˆHzï¼‰
c = 3*10^8;                    % å…‰é€Ÿï¼ˆm/sï¼‰
Eo = sqrt(2);                  % æ­£è¦åŒ–èƒ½é‡ï¼ˆå¾Œé¢ä¹˜åœ¨ç¸½å’Œä¸Šï¼‰
v = 60000/3600;                % ç§»å‹•é€Ÿåº¦ï¼ˆkm/hr â†’ m/sï¼‰

landa = c / f;                % æ³¢é•· Î» = c / f

% æ™‚é–“è»¸å®šç¾©ï¼Œå¾ 0 åˆ° Tï¼Œä»¥ delta_t ç‚ºé–“éš”
% æœƒç”¢ç”Ÿä¸€å€‹æ™‚é–“åºåˆ—ï¼Œç”¨ä¾†è§€å¯Ÿ fading éç¨‹

t = 0:delta_t:T;              

% åŸºåº•å‘é‡ indexï¼ˆfor multiple path sumï¼‰
n = 0:1:N-1;                  % å°æ‡‰æ™‚é–“åºåˆ—æ¨£æœ¬ index
m = 0:1:N-1;                  % ç”¨ä¾†ç”¢ç”Ÿä¸åŒæ–¹å‘èˆ‡ç›¸ä½çš„ index

% baseband representation çš„ä¿‚æ•¸æ­£è¦åŒ–å¸¸æ•¸
cn = sqrt(1/N);               % æ¯å€‹æ•£å°„è·¯å¾‘çš„åŠŸç‡å¹³å‡åŒ–ï¼ˆå‡åˆ†èƒ½é‡ï¼‰

% è¨ˆç®—æœ€å¤§ Doppler é »ç‡ï¼šw_m = 2Ï€f_D
w_m = (2*pi*v) / landa;       % Doppler spreadï¼ˆèˆ‡ç§»å‹•é€Ÿåº¦ã€æ³¢é•·æœ‰é—œï¼‰

% å°‡æ¯æ¢è·¯å¾‘çš„è§’åº¦è½‰æ›æˆåƒæ•¸åŒ–è§’åº¦ rfa_m
rfa_m = (2*pi*m) / N;         % å‡å‹»åˆ†ä½ˆæ–¼ [0, 2Ï€) ç¯„åœå…§
```

---

### âœ… å°æ‡‰åˆ° Jakes æ¨¡å‹å…¬å¼ï¼š

Jakes æ¨¡å‹å®Œæ•´è¡¨é”å¼ï¼š

$$
T(t) = E_0 \sum_{m=1}^N C_m e^{j(\cos\alpha_m \omega_d t + \phi_m)}
$$

| MATLAB è®Šæ•¸  | å°æ‡‰åƒæ•¸       | èªªæ˜                   |
| ---------- | ---------- | -------------------- |
| `Eo`       | $E_0$      | è¼¸å‡ºèƒ½é‡æ”¾å¤§å› å­             |
| `cn`       | $C_m$      | æ¯æ¢è·¯å¾‘çš„æ¬Šé‡ï¼ˆé€šå¸¸å¹³å‡ï¼‰        |
| `rfa_m(i)` | $\alpha_m$ | æ¯æ¢è·¯å¾‘çš„è§’åº¦ï¼ˆç¶“ç”± index å‡åˆ†ï¼‰ |
| `w_m`      | $\omega_d$ | æœ€å¤§ Doppler é »ç‡        |
| `phi_m`    | $\phi_m$   | åˆå§‹ç›¸ä½ï¼ˆéš¨æ©Ÿï¼‰             |
| `t`, `n`   | $t$        | æ™‚é–“åºåˆ—                 |

é€™æ®µ code å°±æ˜¯å®Œæ•´å°æ‡‰ä¸Šé¢å…¬å¼ä¸­æ¯ä¸€é …çš„åˆå§‹åŒ–æ­¥é©Ÿã€‚

---
### ğŸ“Œ Part 2 : è¨ˆç®— Jakes çš„ h(t) 

```markdown
%------------------è¨ˆç®— Jakes çš„ h(t) --------------------%
for i = 1:N
    phi_m = 2*pi*rand(1,1);                       % åˆå§‹éš¨æ©Ÿç›¸ä½ Ï†_m âˆˆ [0, 2Ï€)
    h(i,:) = cn * exp(j*(cos(rfa_m(i))*w_m*n' + phi_m));
end
h_t = Eo * sum(h);                                % å°‡æ‰€æœ‰ N æ¢è·¯å¾‘ç›¸åŠ å¾Œä¹˜ä¸Šèƒ½é‡å› å­
```

---

### âœ… å°æ‡‰åˆ° Jakes æ¨¡å‹å…¬å¼ï¼š

å›é¡§ Jakes æ¨¡å‹æ ¸å¿ƒå…¬å¼ï¼š

$$
T(t) = E_0 \sum_{m=1}^{N} C_m e^{j(\cos\alpha_m \, \omega_d t + \phi_m)}
$$

é€™æ®µç¨‹å¼ç¢¼å°æ‡‰å¦‚ä¸‹ï¼š

| MATLAB ç¨‹å¼ç¢¼                         | å°æ‡‰å…¬å¼é …                                 | èªªæ˜                  |
| ---------------------------------- | ------------------------------------- | ------------------- |
| `phi_m = 2*pi*rand(1,1);`          | $\phi_m \sim \text{Uniform}(0, 2\pi)$ | æ¯æ¢è·¯å¾‘éš¨æ©Ÿåˆå§‹ç›¸ä½          |
| `cos(rfa_m(i)) * w_m * n' + phi_m` | $\cos\alpha_m \, \omega_d t + \phi_m$ | å¤šå¾‘æ–¹å‘é€ æˆä¸åŒ Doppler åç§» |
| `exp(j*(...))`                     | $e^{j(...)}$                          | è¤‡æ•¸æ­£å¼¦æ³¢ï¼ˆæ—‹è½‰å‘é‡ï¼‰         |
| `h(i,:) = cn * exp(...)`           | $C_m e^{j(...)}$                      | æ¯æ¢è·¯å¾‘å¸¶æœ‰ç›¸åŒæ¬Šé‡ C\_m     |
| `h_t = Eo * sum(h);`               | $E_0 \sum_{m=1}^{N} ...$              | æœ€å¾Œçš„é€šé“ä¿‚æ•¸æ˜¯æ‰€æœ‰è·¯å¾‘åŠ ç¸½      |
